<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BIYALA - الدعم والشكاوى</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== نظام الألوان العالمي ===== */
        :root {
            --space-black: #0C0F17;
            --light-text: #E6E6E6;
            --accent-orange: #FF6D1F;
            --danger-red: #ED3F27;
            --success-green: #2ECC71;
            --warning-yellow: #F39C12;
            --info-blue: #3498DB;
            --card-bg: #161B26;
            --overlay-bg: rgba(12, 15, 23, 0.95);
            --border-radius: 24px;
            --border-radius-sm: 16px;
            --border-radius-xs: 12px;
            --shadow-soft: 0 4px 20px rgba(0, 0, 0, 0.25);
            --shadow-medium: 0 6px 30px rgba(0, 0, 0, 0.35);
            --shadow-hard: 0 10px 40px rgba(0, 0, 0, 0.45);
        }

        /* ===== الخطوط ===== */
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'IBM Plex Sans Arabic', sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--space-black);
            color: var(--light-text);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* ===== الشريط العلوي ===== */
        .app-header {
            padding: 15px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            background-color: rgba(12, 15, 23, 0.95);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            z-index: 900;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-gif {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 0 20px rgba(255, 109, 31, 0.4);
            border: 2px solid rgba(255, 109, 31, 0.3);
        }

        .logo-text {
            font-size: 22px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-orange), #FF9E6D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.05);
            width: 42px;
            height: 42px;
            border-radius: 50%;
            color: var(--light-text);
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 109, 31, 0.2);
            transform: translateX(-3px);
        }

        /* ===== صفحة الشكاوى ===== */
        .complaints-page {
            min-height: 100vh;
            padding: 20px 16px;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .complaints-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 0 10px;
        }

        .complaints-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--accent-orange), #FF9E6D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .complaints-subtitle {
            color: #8A8F9C;
            font-size: 16px;
            line-height: 1.5;
        }

        /* ===== التصنيفات السريعة ===== */
        .complaint-categories {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 30px;
        }

        @media (min-width: 768px) {
            .complaint-categories {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .complaint-category {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .complaint-category:hover {
            transform: translateY(-5px);
            border-color: var(--accent-orange);
            box-shadow: 0 10px 25px rgba(255, 109, 31, 0.2);
        }

        .complaint-category.active {
            background: linear-gradient(135deg, var(--accent-orange), #FF9E6D);
            border-color: transparent;
            box-shadow: 0 10px 25px rgba(255, 109, 31, 0.3);
        }

        .complaint-category.active .category-icon,
        .complaint-category.active .category-title,
        .complaint-category.active .category-desc {
            color: var(--space-black);
        }

        .category-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--accent-orange);
            transition: all 0.3s ease;
        }

        .complaint-category.active .category-icon {
            background: rgba(12, 15, 23, 0.2);
        }

        .category-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--light-text);
            transition: all 0.3s ease;
        }

        .category-desc {
            font-size: 12px;
            color: #8A8F9C;
            transition: all 0.3s ease;
        }

        /* ===== نموذج الشكوى ===== */
        .complaint-form-container {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: var(--shadow-soft);
        }

        .form-title {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 25px;
            color: var(--light-text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-title i {
            color: var(--accent-orange);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 15px;
            font-weight: 600;
            color: #D0D5E2;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-label i {
            color: var(--accent-orange);
            width: 18px;
            text-align: center;
        }

        .form-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-sm);
            padding: 16px 20px;
            color: var(--light-text);
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-orange);
            background: rgba(255, 109, 31, 0.05);
        }

        .form-input::placeholder {
            color: #6A6F7C;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
            line-height: 1.5;
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238A8F9C' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: left 20px center;
            background-size: 16px;
            padding-right: 20px;
            cursor: pointer;
        }

        .priority-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .priority-option {
            text-align: center;
            cursor: pointer;
        }

        .priority-option input[type="radio"] {
            display: none;
        }

        .priority-label {
            display: block;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-sm);
            padding: 12px;
            font-size: 14px;
            font-weight: 600;
            color: #9CA3AF;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .priority-option input[type="radio"]:checked+.priority-label {
            border-color: transparent;
            font-weight: 700;
        }

        .priority-option:nth-child(1) input[type="radio"]:checked+.priority-label {
            background: linear-gradient(135deg, var(--danger-red), #FF4757);
            color: white;
        }

        .priority-option:nth-child(2) input[type="radio"]:checked+.priority-label {
            background: linear-gradient(135deg, var(--warning-yellow), #e67e22);
            color: white;
        }

        .priority-option:nth-child(3) input[type="radio"]:checked+.priority-label {
            background: linear-gradient(135deg, var(--info-blue), #2980B9);
            color: white;
        }

        .file-upload {
            border: 2px dashed rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-sm);
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: var(--accent-orange);
            background: rgba(255, 109, 31, 0.05);
        }

        .file-upload i {
            font-size: 40px;
            color: var(--accent-orange);
            margin-bottom: 10px;
        }

        .file-upload span {
            display: block;
            font-weight: 600;
            color: var(--light-text);
            margin-bottom: 5px;
        }

        .file-upload p {
            color: #8A8F9C;
            font-size: 13px;
        }

        .file-input {
            display: none;
        }

        .file-preview {
            margin-top: 15px;
            display: none;
        }

        .file-preview-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--border-radius-xs);
            padding: 12px 15px;
            margin-bottom: 8px;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-icon {
            color: var(--accent-orange);
            font-size: 18px;
        }

        .file-name {
            font-size: 14px;
            color: var(--light-text);
        }

        .remove-file {
            background: none;
            border: none;
            color: var(--danger-red);
            font-size: 16px;
            cursor: pointer;
            padding: 5px;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .form-btn {
            flex: 1;
            padding: 16px;
            border-radius: var(--border-radius-sm);
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--accent-orange), #FF9E6D);
            color: var(--space-black);
            box-shadow: 0 0 20px rgba(255, 109, 31, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(255, 109, 31, 0.5);
        }

        .cancel-btn {
            background: rgba(255, 255, 255, 0.05);
            color: var(--light-text);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .cancel-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* ===== قسم الدردشة الحية ===== */
        .live-support-section {
            margin-top: 40px;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 800;
            color: var(--light-text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--accent-orange);
        }

        .support-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #8A8F9C;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success-green);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }

        .support-chat-container {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: var(--shadow-soft);
        }

        .support-chat-header {
            padding: 20px;
            background: rgba(255, 109, 31, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .support-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-orange), #FF9E6D);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: var(--space-black);
        }

        .support-info h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--light-text);
            margin-bottom: 5px;
        }

        .support-info p {
            font-size: 14px;
            color: #8A8F9C;
        }

        .support-chat-messages {
            height: 300px;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .support-message {
            max-width: 80%;
            animation: messageIn 0.3s ease;
        }

        @keyframes messageIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .support-message.support {
            align-self: flex-start;
        }

        .support-message.user {
            align-self: flex-end;
        }

        .support-message-content {
            padding: 12px 16px;
            border-radius: 20px;
            font-size: 14px;
            line-height: 1.5;
            word-break: break-word;
        }

        .support-message.support .support-message-content {
            background-color: rgba(22, 27, 38, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-bottom-right-radius: 8px;
        }

        .support-message.user .support-message-content {
            background: linear-gradient(135deg, var(--accent-orange), #FF9E6D);
            color: var(--space-black);
            border-bottom-left-radius: 8px;
            font-weight: 600;
        }

        .support-message-time {
            font-size: 11px;
            color: #8A8F9C;
            margin-top: 4px;
            padding: 0 8px;
        }

        .support-message.user .support-message-time {
            text-align: left;
        }

        .support-chat-input {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .support-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            padding: 0 20px;
            height: 48px;
            display: flex;
            align-items: center;
        }

        .support-input input {
            flex: 1;
            background: none;
            border: none;
            color: var(--light-text);
            font-size: 15px;
            padding: 14px 0;
            outline: none;
            width: 100%;
        }

        .support-input input::placeholder {
            color: #6A6F7C;
        }

        .support-send-btn {
            background: linear-gradient(135deg, var(--accent-orange), #FF9E6D);
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            color: var(--space-black);
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(255, 109, 31, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .support-send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(255, 109, 31, 0.6);
        }

        /* ===== الشكاوى السابقة ===== */
        .previous-complaints {
            margin-top: 40px;
        }

        .complaints-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .complaint-item {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .complaint-item:hover {
            transform: translateX(-3px);
            border-color: rgba(255, 109, 31, 0.3);
        }

        .complaint-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .complaint-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--light-text);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .complaint-title i {
            color: var(--accent-orange);
        }

        .complaint-status {
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 700;
        }

        .status-pending {
            background-color: rgba(243, 156, 18, 0.15);
            color: var(--warning-yellow);
        }

        .status-in-progress {
            background-color: rgba(52, 152, 219, 0.15);
            color: var(--info-blue);
        }

        .status-resolved {
            background-color: rgba(46, 204, 113, 0.15);
            color: var(--success-green);
        }

        .status-closed {
            background-color: rgba(108, 117, 125, 0.15);
            color: #6C757D;
        }

        .complaint-details {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }

        .complaint-detail {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #8A8F9C;
        }

        .complaint-detail i {
            color: var(--accent-orange);
        }

        .complaint-description {
            font-size: 14px;
            color: #B0B5C2;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .complaint-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 8px 16px;
            border-radius: var(--border-radius-xs);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .view-btn {
            background: rgba(255, 109, 31, 0.1);
            color: var(--accent-orange);
            border: 1px solid rgba(255, 109, 31, 0.2);
        }

        .view-btn:hover {
            background: rgba(255, 109, 31, 0.2);
        }

        .follow-btn {
            background: rgba(52, 152, 219, 0.1);
            color: var(--info-blue);
            border: 1px solid rgba(52, 152, 219, 0.2);
        }

        .follow-btn:hover {
            background: rgba(52, 152, 219, 0.2);
        }

        .no-complaints {
            text-align: center;
            padding: 50px 20px;
            color: #8A8F9C;
        }

        .no-complaints i {
            font-size: 60px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .no-complaints h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--light-text);
        }

        .no-complaints p {
            font-size: 15px;
            line-height: 1.6;
        }

        /* ===== نافذة تفاصيل الشكوى ===== */
        .complaint-detail-overlay {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-color: var(--overlay-bg);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
        }

        .complaint-detail-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .complaint-detail-card {
            width: 100%;
            max-width: 500px;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow-hard);
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .complaint-detail-header {
            margin-bottom: 25px;
        }

        .complaint-detail-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--light-text);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .complaint-detail-id {
            font-size: 14px;
            color: #8A8F9C;
            background: rgba(255, 255, 255, 0.05);
            padding: 4px 12px;
            border-radius: 20px;
        }

        .complaint-detail-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            margin-bottom: 15px;
        }

        .complaint-detail-content {
            margin-bottom: 30px;
        }

        .complaint-detail-section {
            margin-bottom: 25px;
        }

        .detail-section-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--light-text);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .detail-section-title i {
            color: var(--accent-orange);
        }

        .complaint-detail-text {
            font-size: 15px;
            line-height: 1.6;
            color: #B0B5C2;
            margin-bottom: 20px;
        }

        .complaint-detail-meta {
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--border-radius-sm);
            padding: 20px;
        }

        .detail-meta-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .detail-meta-item:last-child {
            border-bottom: none;
        }

        .meta-label {
            color: #8A8F9C;
            font-weight: 600;
            font-size: 14px;
        }

        .meta-value {
            color: var(--light-text);
            font-weight: 500;
            font-size: 14px;
        }

        .timeline {
            margin-top: 25px;
        }

        .timeline-item {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .timeline-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .timeline-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-orange);
            flex-shrink: 0;
            position: relative;
        }

        .timeline-dot::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 9px;
            width: 2px;
            height: calc(100% + 20px);
            background: rgba(255, 109, 31, 0.3);
        }

        .timeline-item:last-child .timeline-dot::after {
            display: none;
        }

        .timeline-content {
            flex: 1;
        }

        .timeline-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--light-text);
            margin-bottom: 5px;
        }

        .timeline-desc {
            font-size: 14px;
            color: #8A8F9C;
            margin-bottom: 8px;
        }

        .timeline-time {
            font-size: 12px;
            color: #6C757D;
        }

        .close-detail-btn {
            position: absolute;
            top: 25px;
            left: 25px;
            background: rgba(255, 255, 255, 0.12);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: var(--light-text);
            font-size: 16px;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .close-detail-btn:hover {
            background: rgba(255, 109, 31, 0.3);
            transform: rotate(90deg);
        }

        /* ===== رسائل التنبيه ===== */
        .alert-message {
            position: fixed;
            top: 80px;
            right: 20px;
            left: 20px;
            background: linear-gradient(135deg, var(--success-green), #27ae60);
            color: white;
            padding: 15px 20px;
            border-radius: var(--border-radius-sm);
            text-align: center;
            font-weight: 700;
            z-index: 3000;
            animation: slideDown 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
            box-shadow: 0 5px 25px rgba(46, 204, 113, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            display: none;
        }

        .alert-message.error {
            background: linear-gradient(135deg, var(--danger-red), #c0392b);
            box-shadow: 0 5px 25px rgba(231, 76, 60, 0.4);
        }

        .alert-message.warning {
            background: linear-gradient(135deg, var(--warning-yellow), #e67e22);
            box-shadow: 0 5px 25px rgba(243, 156, 18, 0.4);
        }

        .alert-message.info {
            background: linear-gradient(135deg, var(--info-blue), #2980B9);
            box-shadow: 0 5px 25px rgba(52, 152, 219, 0.4);
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
            }
        }

        /* ===== تحسينات عامة ===== */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(22, 27, 38, 0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-orange);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #FF8A4D;
        }

        /* ===== Media Queries ===== */
        @media (max-width: 480px) {
            .complaint-categories {
                grid-template-columns: 1fr;
            }

            .priority-options {
                grid-template-columns: 1fr;
            }

            .form-actions {
                flex-direction: column;
            }

            .complaint-detail-card {
                padding: 20px;
            }

            .complaint-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .complaint-actions {
                width: 100%;
            }

            .action-btn {
                flex: 1;
                justify-content: center;
            }
        }

        @media (min-width: 768px) {
            .complaints-page {
                max-width: 800px;
                margin: 0 auto;
            }

            .support-chat-container {
                display: flex;
                height: 400px;
            }

            .support-chat-messages {
                flex: 1;
                height: auto;
            }

            .support-chat-input {
                border-top: none;
                border-left: 1px solid rgba(255, 255, 255, 0.05);
                flex-direction: column;
                justify-content: flex-end;
                width: 250px;
            }

            .support-input {
                width: 100%;
            }
        }

        @media (min-width: 1024px) {
            .complaints-page {
                max-width: 900px;
            }

            .support-chat-input {
                width: 300px;
            }
        }

        /* تحسينات للمس */
        @media (hover: none) and (pointer: coarse) {

            .complaint-category:active,
            .complaint-item:active,
            .form-btn:active,
            .action-btn:active,
            .support-send-btn:active {
                transform: scale(0.98);
                opacity: 0.9;
            }
        }

        /* تحسين إمكانية الوصول */
        :focus {
            outline: 2px solid var(--accent-orange);
            outline-offset: 2px;
        }

        /* تأمين أن النماذج تستجيب */
        input,
        select,
        textarea,
        button {
            font-size: 16px;
            max-width: 100%;
        }
    </style>
</head>

<body>
    <!-- الشريط العلوي -->
    <div class="app-header">
        <div class="logo-container">
            <button class="back-btn" id="back-btn">
                <i class="fas fa-arrow-right"></i>
            </button>

            <div class="logo-text">الدعم والشكاوى</div>
        </div>
    </div>

    <!-- صفحة الشكاوى -->
    <div class="complaints-page" id="complaints-page">
        <!-- العنوان -->
        <div class="complaints-header">
            <h1 class="complaints-title">مركز الدعم والشكاوى</h1>
            <p class="complaints-subtitle">نحن هنا لمساعدتك! اختر نوع المشكلة أو تحدث مع دعمنا المباشر</p>
        </div>

        <!-- التصنيفات السريعة -->
        <div class="complaint-categories">
            <div class="complaint-category active" data-category="shipping">
                <div class="category-icon">
                    <i class="fas fa-shipping-fast"></i>
                </div>
                <div class="category-title">مشاكل الشحن</div>
                <div class="category-desc">تأخير أو مشاكل في التوصيل</div>
            </div>

            <div class="complaint-category" data-category="product">
                <div class="category-icon">
                    <i class="fas fa-tshirt"></i>
                </div>
                <div class="category-title">منتج غير مطابق</div>
                <div class="category-desc">المنتج مختلف عن الوصف</div>
            </div>

            <div class="complaint-category" data-category="payment">
                <div class="category-icon">
                    <i class="fas fa-credit-card"></i>
                </div>
                <div class="category-title">مشاكل الدفع</div>
                <div class="category-desc">أخطاء في الفواتير أو الدفع</div>
            </div>

            <div class="complaint-category" data-category="other">
                <div class="category-icon">
                    <i class="fas fa-question-circle"></i>
                </div>
                <div class="category-title">أخرى</div>
                <div class="category-desc">مشاكل أو استفسارات أخرى</div>
            </div>
        </div>

        <!-- نموذج الشكوى -->
        <div class="complaint-form-container">
            <h2 class="form-title">
                <i class="fas fa-edit"></i>
                إرسال شكوى جديدة
            </h2>

            <form id="complaint-form">
                <div class="form-group">
                    <label class="form-label" for="complaint-title">
                        <i class="fas fa-heading"></i>
                        عنوان الشكوى
                    </label>
                    <input type="text" id="complaint-title" class="form-input"
                        placeholder="مثال: تأخر في توصيل الطلب رقم #1234" required>
                </div>

                <div class="form-group">
                    <label class="form-label" for="complaint-type">
                        <i class="fas fa-tag"></i>
                        نوع الشكوى
                    </label>
                    <select id="complaint-type" class="form-input form-select" required>
                        <option value="">اختر نوع الشكوى</option>
                        <option value="shipping">مشكلة في الشحن</option>
                        <option value="product">منتج غير مطابق</option>
                        <option value="payment">مشكلة في الدفع</option>
                        <option value="quality">جودة المنتج</option>
                        <option value="service">خدمة العملاء</option>
                        <option value="other">أخرى</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-exclamation-triangle"></i>
                        الأولوية
                    </label>
                    <div class="priority-options">
                        <div class="priority-option">
                            <input type="radio" id="priority-high" name="priority" value="high">
                            <label for="priority-high" class="priority-label">عاجل</label>
                        </div>
                        <div class="priority-option">
                            <input type="radio" id="priority-medium" name="priority" value="medium" checked>
                            <label for="priority-medium" class="priority-label">متوسط</label>
                        </div>
                        <div class="priority-option">
                            <input type="radio" id="priority-low" name="priority" value="low">
                            <label for="priority-low" class="priority-label">منخفض</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="order-number">
                        <i class="fas fa-hashtag"></i>
                        رقم الطلب (إن وجد)
                    </label>
                    <input type="text" id="order-number" class="form-input" placeholder="مثال: #ORD-1234">
                </div>

                <div class="form-group">
                    <label class="form-label" for="complaint-description">
                        <i class="fas fa-align-left"></i>
                        وصف المشكلة
                    </label>
                    <textarea id="complaint-description" class="form-input form-textarea"
                        placeholder="صف مشكلتك بالتفصيل..." required></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-paperclip"></i>
                        إرفاق ملفات (اختياري)
                    </label>
                    <div class="file-upload" id="file-upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <span>اسحب وأفلت الملفات هنا</span>
                        <p>أو انقر لاختيار ملفات</p>
                        <p style="font-size: 11px; margin-top: 5px;">JPG, PNG, PDF, DOC (حتى 10MB)</p>
                        <input type="file" id="file-input" class="file-input" multiple accept="image/*,.pdf,.doc,.docx">
                    </div>
                    <div class="file-preview" id="file-preview"></div>
                </div>

                <div class="form-actions">
                    <button type="button" class="form-btn cancel-btn" id="cancel-complaint">
                        <i class="fas fa-times"></i>
                        إلغاء
                    </button>
                    <button type="submit" class="form-btn submit-btn" id="submit-complaint">
                        <i class="fas fa-paper-plane"></i>
                        إرسال الشكوى
                    </button>
                </div>
            </form>
        </div>

        <!-- الدردشة الحية مع الدعم -->
        <div class="live-support-section">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-comments"></i>
                    دردشة مباشرة مع الدعم
                </h2>
                <div class="support-status">
                    <div class="status-dot"></div>
                    <span>متصل الآن</span>
                </div>
            </div>

            <div class="support-chat-container">
                <div class="support-chat-messages" id="support-chat-messages">
                    <!-- الرسائل تضاف هنا -->
                </div>

                <div class="support-chat-input">
                    <div class="support-input">
                        <input type="text" id="support-chat-input" placeholder="اكتب رسالتك هنا...">
                    </div>
                    <button class="support-send-btn" id="support-send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- الشكاوى السابقة -->
        <div class="previous-complaints">
            <h2 class="section-title">
                <i class="fas fa-history"></i>
                شكاويك السابقة
            </h2>

            <div class="complaints-list" id="previous-complaints">
                <!-- الشكاوى تضاف هنا -->
            </div>
        </div>
    </div>

    <!-- نافذة تفاصيل الشكوى -->
    <div class="complaint-detail-overlay" id="complaint-detail-overlay">
        <div class="complaint-detail-card">
            <button class="close-detail-btn" id="close-detail-btn">
                <i class="fas fa-times"></i>
            </button>

            <div class="complaint-detail-header">
                <div class="complaint-detail-title">
                    <span id="detail-complaint-title">تأخر في توصيل الطلب</span>
                    <span class="complaint-detail-id" id="detail-complaint-id">#CMP-001</span>
                </div>
                <div class="complaint-detail-status" id="detail-complaint-status"></div>
            </div>

            <div class="complaint-detail-content">
                <div class="complaint-detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-info-circle"></i>
                        تفاصيل الشكوى
                    </h3>
                    <div class="complaint-detail-text" id="detail-complaint-description">
                        وصف الشكوى يظهر هنا...
                    </div>
                </div>

                <div class="complaint-detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-list-alt"></i>
                        معلومات الشكوى
                    </h3>
                    <div class="complaint-detail-meta">
                        <div class="detail-meta-item">
                            <span class="meta-label">نوع الشكوى:</span>
                            <span class="meta-value" id="detail-complaint-type">مشكلة في الشحن</span>
                        </div>
                        <div class="detail-meta-item">
                            <span class="meta-label">رقم الطلب:</span>
                            <span class="meta-value" id="detail-order-number">#ORD-1234</span>
                        </div>
                        <div class="detail-meta-item">
                            <span class="meta-label">الأولوية:</span>
                            <span class="meta-value" id="detail-priority">متوسط</span>
                        </div>
                        <div class="detail-meta-item">
                            <span class="meta-label">تاريخ الإرسال:</span>
                            <span class="meta-value" id="detail-created-date">15 أكتوبر 2024</span>
                        </div>
                        <div class="detail-meta-item">
                            <span class="meta-label">آخر تحديث:</span>
                            <span class="meta-value" id="detail-updated-date">16 أكتوبر 2024</span>
                        </div>
                    </div>
                </div>

                <div class="complaint-detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-history"></i>
                        سجل المتابعة
                    </h3>
                    <div class="timeline" id="detail-timeline">
                        <!-- الخط الزمني يضاف هنا -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- رسائل التنبيه -->
    <div class="alert-message" id="global-alert"></div>

    <script>
        // ==== بيانات التطبيق ====
        const complaints = [
            {
                id: "CMP-001",
                title: "تأخر في توصيل الطلب",
                type: "shipping",
                priority: "high",
                orderNumber: "#ORD-7823",
                description: "طلب رقم #ORD-7823 تأخر في التسليم أكثر من 5 أيام عن الموعد المحدد. تم التأكيد بأن الطلب سيصل خلال 3 أيام عمل.",
                status: "in-progress",
                createdAt: "2024-10-15",
                updatedAt: "2024-10-16",
                files: [],
                timeline: [
                    {
                        title: "تم إنشاء الشكوى",
                        description: "تم تسجيل الشكوى بنجاح",
                        time: "15 أكتوبر 2024 - 10:30 ص"
                    },
                    {
                        title: "قيد المراجعة",
                        description: "الشكوى قيد المراجعة من قبل فريق الدعم",
                        time: "15 أكتوبر 2024 - 02:15 م"
                    },
                    {
                        title: "تم التواصل مع فريق الشحن",
                        description: "تم التواصل مع فريق الشحن لمتابعة الطلب",
                        time: "16 أكتوبر 2024 - 09:45 ص"
                    }
                ]
            },
            {
                id: "CMP-002",
                title: "منتج غير مطابق للوصف",
                type: "product",
                priority: "medium",
                orderNumber: "#ORD-7815",
                description: "المنتج المستلم يختلف عن الصورة المعروضة على المنصة. اللون والحجم غير متطابقين مع الوصف.",
                status: "resolved",
                createdAt: "2024-10-05",
                updatedAt: "2024-10-08",
                files: [],
                timeline: [
                    {
                        title: "تم إنشاء الشكوى",
                        description: "تم تسجيل الشكوى بنجاح",
                        time: "5 أكتوبر 2024 - 11:20 ص"
                    },
                    {
                        title: "طلب استبدال المنتج",
                        description: "تم إنشاء طلب استبدال للمنتج",
                        time: "6 أكتوبر 2024 - 10:15 ص"
                    },
                    {
                        title: "تم حل المشكلة",
                        description: "تم استبدال المنتج بنجاح",
                        time: "8 أكتوبر 2024 - 03:30 م"
                    }
                ]
            },
            {
                id: "CMP-003",
                title: "مشكلة في عملية الدفع",
                type: "payment",
                priority: "high",
                orderNumber: "#ORD-7801",
                description: "تم خصم المبلغ مرتين من حسابي البنكي عند محاولة الشراء.",
                status: "pending",
                createdAt: "2024-10-18",
                updatedAt: "2024-10-18",
                files: [],
                timeline: [
                    {
                        title: "تم إنشاء الشكوى",
                        description: "تم تسجيل الشكوى بنجاح",
                        time: "18 أكتوبر 2024 - 09:15 ص"
                    }
                ]
            }
        ];

        const supportAgents = [
            { name: "أحمد محمد", role: "ممثل الدعم", online: true },
            { name: "سارة علي", role: "مدير الشكاوى", online: true },
            { name: "محمد خالد", role: "دعم فني", online: true }
        ];

        let currentComplaint = null;
        let uploadedFiles = [];

        // ==== تهيئة التطبيق ====
        document.addEventListener('DOMContentLoaded', function () {
            initializeComplaintsPage();
        });

        function initializeComplaintsPage() {
            // إعداد تصنيفات الشكاوى
            setupComplaintCategories();

            // إعداد نموذج الشكوى
            setupComplaintForm();

            // إعداد الدردشة مع الدعم
            setupSupportChat();

            // إعداد الشكاوى السابقة
            loadPreviousComplaints();

            // إعداد الأحداث
            setupEventListeners();

            // إضافة رسالة ترحيب في الدردشة
            setTimeout(() => {
                addSupportMessage('support', 'مرحباً بك في مركز الدعم! 👋 أنا هنا لمساعدتك في أي استفسار أو مشكلة تواجهها.');
            }, 1000);
        }

        // ==== إعداد تصنيفات الشكاوى ====
        function setupComplaintCategories() {
            const categories = document.querySelectorAll('.complaint-category');

            categories.forEach(category => {
                category.addEventListener('click', function () {
                    // إزالة النشاط من جميع التصنيفات
                    categories.forEach(c => c.classList.remove('active'));

                    // إضافة النشاط للتصنيف المحدد
                    this.classList.add('active');

                    // تحديث نوع الشكوى في النموذج
                    const complaintType = this.dataset.category;
                    const typeMap = {
                        'shipping': 'مشكلة في الشحن',
                        'product': 'منتج غير مطابق',
                        'payment': 'مشكلة في الدفع',
                        'other': 'أخرى'
                    };

                    const selectElement = document.getElementById('complaint-type');
                    if (selectElement) {
                        for (let option of selectElement.options) {
                            if (option.text === typeMap[complaintType]) {
                                selectElement.value = option.value;
                                break;
                            }
                        }
                    }
                });
            });
        }

        // ==== إعداد نموذج الشكوى ====
        function setupComplaintForm() {
            const form = document.getElementById('complaint-form');
            const fileUploadArea = document.getElementById('file-upload-area');
            const fileInput = document.getElementById('file-input');
            const filePreview = document.getElementById('file-preview');

            if (form) {
                form.addEventListener('submit', function (e) {
                    e.preventDefault();
                    submitComplaint();
                });
            }

            if (fileUploadArea && fileInput) {
                // النقر على منطقة الرفع
                fileUploadArea.addEventListener('click', function () {
                    fileInput.click();
                });

                // سحب وإفلات الملفات
                fileUploadArea.addEventListener('dragover', function (e) {
                    e.preventDefault();
                    this.style.borderColor = 'var(--accent-orange)';
                    this.style.background = 'rgba(255, 109, 31, 0.05)';
                });

                fileUploadArea.addEventListener('dragleave', function () {
                    this.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                    this.style.background = '';
                });

                fileUploadArea.addEventListener('drop', function (e) {
                    e.preventDefault();
                    this.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                    this.style.background = '';

                    if (e.dataTransfer.files.length > 0) {
                        handleFileUpload(e.dataTransfer.files);
                    }
                });

                // تغيير الملفات المختارة
                fileInput.addEventListener('change', function (e) {
                    if (this.files.length > 0) {
                        handleFileUpload(this.files);
                    }
                });
            }

            // زر الإلغاء
            const cancelBtn = document.getElementById('cancel-complaint');
            if (cancelBtn) {
                cancelBtn.addEventListener('click', function () {
                    if (confirm('هل تريد إلغاء الشكوى؟ سيتم فقدان جميع البيانات التي أدخلتها.')) {
                        resetComplaintForm();
                    }
                });
            }
        }

        function handleFileUpload(files) {
            const maxSize = 10 * 1024 * 1024; // 10MB
            const allowedTypes = ['image/jpeg', 'image/png', 'image/jpg', 'application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];

            for (let file of files) {
                // التحقق من نوع الملف
                if (!allowedTypes.includes(file.type)) {
                    showAlert(`نوع الملف ${file.name} غير مدعوم`, 'error');
                    continue;
                }

                // التحقق من حجم الملف
                if (file.size > maxSize) {
                    showAlert(`حجم الملف ${file.name} كبير جداً (الحد الأقصى 10MB)`, 'error');
                    continue;
                }

                // إضافة الملف إلى القائمة
                uploadedFiles.push({
                    name: file.name,
                    size: formatFileSize(file.size),
                    type: file.type.split('/')[1] || 'unknown',
                    file: file
                });
            }

            // تحديث معاينة الملفات
            updateFilePreview();
        }

        function updateFilePreview() {
            const filePreview = document.getElementById('file-preview');
            if (!filePreview) return;

            if (uploadedFiles.length === 0) {
                filePreview.style.display = 'none';
                return;
            }

            filePreview.style.display = 'block';
            filePreview.innerHTML = '';

            uploadedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-preview-item';
                fileItem.innerHTML = `
                    <div class="file-info">
                        <i class="fas fa-file file-icon"></i>
                        <span class="file-name">${file.name} (${file.size})</span>
                    </div>
                    <button class="remove-file" data-index="${index}">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                filePreview.appendChild(fileItem);
            });

            // إضافة أحداث إزالة الملفات
            document.querySelectorAll('.remove-file').forEach(btn => {
                btn.addEventListener('click', function () {
                    const index = parseInt(this.dataset.index);
                    uploadedFiles.splice(index, 1);
                    updateFilePreview();
                });
            });
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function submitComplaint() {
            const title = document.getElementById('complaint-title').value.trim();
            const type = document.getElementById('complaint-type').value;
            const priority = document.querySelector('input[name="priority"]:checked')?.value;
            const orderNumber = document.getElementById('order-number').value.trim();
            const description = document.getElementById('complaint-description').value.trim();

            // التحقق من البيانات
            if (!title || !type || !priority || !description) {
                showAlert('يرجى ملء جميع الحقول المطلوبة', 'error');
                return;
            }

            // إنشاء شكوى جديدة
            const newComplaint = {
                id: `CMP-${String(complaints.length + 1).padStart(3, '0')}`,
                title: title,
                type: type,
                priority: priority,
                orderNumber: orderNumber || 'غير محدد',
                description: description,
                status: 'pending',
                createdAt: new Date().toLocaleDateString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                }),
                updatedAt: new Date().toLocaleDateString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                }),
                files: [...uploadedFiles],
                timeline: [
                    {
                        title: "تم إنشاء الشكوى",
                        description: "تم تسجيل الشكوى بنجاح",
                        time: new Date().toLocaleString('ar-EG', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        })
                    }
                ]
            };

            // إضافة الشكوى إلى القائمة
            complaints.unshift(newComplaint);

            // عرض رسالة نجاح
            showAlert('تم إرسال الشكوى بنجاح! رقم الشكوى: ' + newComplaint.id, 'success');

            // إضافة رسالة في الدردشة
            addSupportMessage('support', `شكراً لتواصلك! تم استلام شكوتك برقم ${newComplaint.id}. سنقوم بالرد عليك خلال 24 ساعة.`);

            // إعادة تعيين النموذج
            resetComplaintForm();

            // تحديث قائمة الشكاوى
            loadPreviousComplaints();

            // إضافة الشكوى إلى الشكاوى السابقة في الواجهة
            addComplaintToPrevious(newComplaint);
        }

        function resetComplaintForm() {
            const form = document.getElementById('complaint-form');
            if (form) form.reset();

            uploadedFiles = [];
            updateFilePreview();

            // إعادة تعيين التصنيف النشط
            document.querySelectorAll('.complaint-category').forEach((category, index) => {
                category.classList.remove('active');
                if (index === 0) category.classList.add('active');
            });
        }

        // ==== إعداد الدردشة مع الدعم ====
        function setupSupportChat() {
            const chatInput = document.getElementById('support-chat-input');
            const sendBtn = document.getElementById('support-send-btn');

            if (chatInput && sendBtn) {
                // إرسال الرسالة عند الضغط على Enter
                chatInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        sendSupportMessage();
                    }
                });

                // إرسال الرسالة عند النقر على الزر
                sendBtn.addEventListener('click', sendSupportMessage);
            }
        }

        function sendSupportMessage() {
            const chatInput = document.getElementById('support-chat-input');
            if (!chatInput) return;

            const message = chatInput.value.trim();

            if (message) {
                // إضافة رسالة المستخدم
                addSupportMessage('user', message);
                chatInput.value = '';

                // محاكاة رد الدعم بعد تأخير
                setTimeout(() => {
                    const response = getSupportResponse(message);
                    addSupportMessage('support', response);
                }, 1500);
            }
        }

        function addSupportMessage(sender, text) {
            const messagesContainer = document.getElementById('support-chat-messages');
            if (!messagesContainer) return;

            const messageDiv = document.createElement('div');
            messageDiv.className = `support-message ${sender}`;

            const time = new Date().toLocaleTimeString('ar-EG', {
                hour: '2-digit',
                minute: '2-digit'
            });

            messageDiv.innerHTML = `
                <div class="support-message-content">${text}</div>
                <div class="support-message-time">${time}</div>
            `;

            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function getSupportResponse(message) {
            const lowerMessage = message.toLowerCase();

            if (lowerMessage.includes('شكوى') || lowerMessage.includes('مشكلة')) {
                return 'يمكنك إرسال شكوى باستخدام النموذج أعلاه، وسأقوم بمتابعتها مع فريق الدعم.';
            } else if (lowerMessage.includes('تتبع') || lowerMessage.includes('متى')) {
                return 'لمتابعة شكوى قائمة، يمكنك الضغط على الشكوى من القائمة السابقة لعرض تفاصيلها ومتابعتها.';
            } else if (lowerMessage.includes('شكراً') || lowerMessage.includes('شكرا')) {
                return 'العفو! نحن دائماً هنا لمساعدتك. هل هناك أي شيء آخر تحتاج إليه؟';
            } else if (lowerMessage.includes('مرحباً') || lowerMessage.includes('اهلاً')) {
                return 'أهلاً وسهلاً بك! كيف يمكنني مساعدتك اليوم؟';
            } else {
                const responses = [
                    'شكراً لرسالتك! هل يمكنك توضيح مشكلتك أكثر؟',
                    'أفهم ما تقصده. هل تريد إرسال شكوى رسمية أم استفسار فقط؟',
                    'سأقوم بتوجيه سؤالك إلى الفريق المختص والرد عليك قريباً.',
                    'للشكاوى الرسمية، يرجى استخدام النموذج المخصص للحصول على رقم متابعة.'
                ];
                return responses[Math.floor(Math.random() * responses.length)];
            }
        }

        // ==== إدارة الشكاوى السابقة ====
        function loadPreviousComplaints() {
            const complaintsList = document.getElementById('previous-complaints');
            if (!complaintsList) return;

            if (complaints.length === 0) {
                complaintsList.innerHTML = `
                    <div class="no-complaints">
                        <i class="fas fa-inbox"></i>
                        <h3>لا توجد شكاوى سابقة</h3>
                        <p>لم تقم بإرسال أي شكاوى بعد</p>
                    </div>
                `;
                return;
            }

            complaintsList.innerHTML = '';

            complaints.forEach(complaint => {
                addComplaintToPrevious(complaint);
            });
        }

        function addComplaintToPrevious(complaint) {
            const complaintsList = document.getElementById('previous-complaints');
            if (!complaintsList) return;

            const statusMap = {
                'pending': { text: 'قيد الانتظار', class: 'status-pending' },
                'in-progress': { text: 'قيد المعالجة', class: 'status-in-progress' },
                'resolved': { text: 'تم الحل', class: 'status-resolved' },
                'closed': { text: 'مغلق', class: 'status-closed' }
            };

            const typeMap = {
                'shipping': 'مشكلة في الشحن',
                'product': 'منتج غير مطابق',
                'payment': 'مشكلة في الدفع',
                'quality': 'جودة المنتج',
                'service': 'خدمة العملاء',
                'other': 'أخرى'
            };

            const status = statusMap[complaint.status] || statusMap.pending;
            const type = typeMap[complaint.type] || 'غير محدد';

            const complaintElement = document.createElement('div');
            complaintElement.className = 'complaint-item';
            complaintElement.dataset.id = complaint.id;

            complaintElement.innerHTML = `
                <div class="complaint-header">
                    <div class="complaint-title">
                        <i class="fas fa-exclamation-circle"></i>
                        ${complaint.title}
                    </div>
                    <div class="complaint-status ${status.class}">
                        ${status.text}
                    </div>
                </div>
                
                <div class="complaint-details">
                    <div class="complaint-detail">
                        <i class="fas fa-hashtag"></i>
                        <span>${complaint.id}</span>
                    </div>
                    <div class="complaint-detail">
                        <i class="fas fa-tag"></i>
                        <span>${type}</span>
                    </div>
                    <div class="complaint-detail">
                        <i class="fas fa-calendar"></i>
                        <span>${complaint.createdAt}</span>
                    </div>
                </div>
                
                <div class="complaint-description">
                    ${complaint.description}
                </div>
                
                <div class="complaint-actions">
                    <button class="action-btn view-btn view-complaint-btn" data-id="${complaint.id}">
                        <i class="fas fa-eye"></i>
                        عرض التفاصيل
                    </button>
                    <button class="action-btn follow-btn follow-complaint-btn" data-id="${complaint.id}">
                        <i class="fas fa-sync-alt"></i>
                        متابعة
                    </button>
                </div>
            `;

            complaintsList.prepend(complaintElement);

            // إضافة أحداث للزر
            complaintElement.querySelector('.view-complaint-btn').addEventListener('click', function (e) {
                e.stopPropagation();
                const complaintId = this.dataset.id;
                showComplaintDetail(complaintId);
            });

            complaintElement.querySelector('.follow-complaint-btn').addEventListener('click', function (e) {
                e.stopPropagation();
                const complaintId = this.dataset.id;
                followComplaint(complaintId);
            });

            complaintElement.addEventListener('click', function () {
                const complaintId = this.dataset.id;
                showComplaintDetail(complaintId);
            });
        }

        function showComplaintDetail(complaintId) {
            const complaint = complaints.find(c => c.id === complaintId);
            if (!complaint) return;

            currentComplaint = complaint;

            const statusMap = {
                'pending': { text: 'قيد الانتظار', class: 'status-pending' },
                'in-progress': { text: 'قيد المعالجة', class: 'status-in-progress' },
                'resolved': { text: 'تم الحل', class: 'status-resolved' },
                'closed': { text: 'مغلق', class: 'status-closed' }
            };

            const typeMap = {
                'shipping': 'مشكلة في الشحن',
                'product': 'منتج غير مطابق',
                'payment': 'مشكلة في الدفع',
                'quality': 'جودة المنتج',
                'service': 'خدمة العملاء',
                'other': 'أخرى'
            };

            const priorityMap = {
                'high': 'عاجل',
                'medium': 'متوسط',
                'low': 'منخفض'
            };

            const status = statusMap[complaint.status] || statusMap.pending;

            // تحديث بيانات النافذة
            document.getElementById('detail-complaint-title').textContent = complaint.title;
            document.getElementById('detail-complaint-id').textContent = complaint.id;
            document.getElementById('detail-complaint-status').innerHTML = `
                <span>${status.text}</span>
            `;
            document.getElementById('detail-complaint-status').className = `complaint-detail-status ${status.class}`;

            document.getElementById('detail-complaint-description').textContent = complaint.description;
            document.getElementById('detail-complaint-type').textContent = typeMap[complaint.type] || 'غير محدد';
            document.getElementById('detail-order-number').textContent = complaint.orderNumber;
            document.getElementById('detail-priority').textContent = priorityMap[complaint.priority] || 'غير محدد';
            document.getElementById('detail-created-date').textContent = complaint.createdAt;
            document.getElementById('detail-updated-date').textContent = complaint.updatedAt;

            // تحديث الخط الزمني
            const timelineElement = document.getElementById('detail-timeline');
            if (timelineElement) {
                timelineElement.innerHTML = '';

                complaint.timeline.forEach((item, index) => {
                    const timelineItem = document.createElement('div');
                    timelineItem.className = 'timeline-item';
                    timelineItem.innerHTML = `
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">${item.title}</div>
                            <div class="timeline-desc">${item.description}</div>
                            <div class="timeline-time">${item.time}</div>
                        </div>
                    `;
                    timelineElement.appendChild(timelineItem);
                });
            }

            // إظهار النافذة
            document.getElementById('complaint-detail-overlay').classList.add('active');
        }

        function followComplaint(complaintId) {
            const complaint = complaints.find(c => c.id === complaintId);
            if (!complaint) return;

            // إضافة تحديث إلى الخط الزمني
            const newUpdate = {
                title: "طلب متابعة",
                description: "تم طلب متابعة الشكوى من قبل المستخدم",
                time: new Date().toLocaleString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                })
            };

            complaint.timeline.push(newUpdate);
            complaint.updatedAt = new Date().toLocaleDateString('ar-EG', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            showAlert('تم طلب متابعة الشكوى بنجاح', 'info');

            // إضافة رسالة في الدردشة
            addSupportMessage('support', `تم تسجيل طلب متابعة لشكوى ${complaintId}. سنقوم بالرد عليك قريباً.`);
        }

        // ==== الأحداث العامة ====
        function setupEventListeners() {
            // زر العودة
            const backBtn = document.getElementById('back-btn');
            if (backBtn) {
                backBtn.addEventListener('click', function () {
                    // هنا يمكنك إضافة منطق للعودة للصفحة السابقة
                    // على سبيل المثال:
                    window.history.back();
                    // أو الانتقال لصفحة محددة:
                    // window.location.href = 'index.html';
                });
            }

            // إغلاق نافذة التفاصيل
            const closeDetailBtn = document.getElementById('close-detail-btn');
            if (closeDetailBtn) {
                closeDetailBtn.addEventListener('click', function () {
                    document.getElementById('complaint-detail-overlay').classList.remove('active');
                });
            }

            // إغلاق النافذة عند النقر خارجها
            document.getElementById('complaint-detail-overlay')?.addEventListener('click', function (e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        }

        // ==== وظائف مساعدة ====
        function showAlert(message, type = 'success') {
            const alertElement = document.getElementById('global-alert');
            if (!alertElement) return;

            alertElement.textContent = message;
            alertElement.className = `alert-message ${type}`;
            alertElement.style.display = 'flex';

            setTimeout(() => {
                alertElement.style.display = 'none';
            }, 3000);
        }

        // ==== تهيئة نهائية ====
        window.addEventListener('load', function () {
            // التأكد من تحميل الصفحة بشكل صحيح
            console.log('صفحة الشكاوى جاهزة للاستخدام!');
        });
    </script>
</body>

</html>